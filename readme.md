# 使用说明

适用于CDS2.5版本客户端以及AIC自动安装项目,需要使用修改过的SPT配置文件,否则无论如何都会在安装过程中自动重启从而导致安装过程中断.大部分必要的系统设置通过组策略实现,脚本中可以自动将netfx相关的项目进行激活.

## 预期安装效果

安装完毕后,客户端以及AIC会具有指定的驱动版本以及补丁版本,指定的路径中会有简单的安装汇总,升级(如果有)汇总以及SVT汇总

每台计算机预计花费20分钟时间,可以同时进行操作,也可以使用psexec进行批量推送,具体使用方式网上教程很多,不再赘述

## 限制

自动安装的驱动仅限于msi格式的安装包,如果非msi安装包有静默参数(具体实现方式可以参考palxt驱动的安装命令),也可以修改脚本实现自动安装,但是目前Thermo SII以及Waters驱动均不具有静默安装参数,故无法实现

## 准备条件

1. 服务器安装完毕,所有相关计算机加域完成,计算机相关的系统设置完成
2. **PowerShell脚本执行权限设置为允许所有(可以通过组策略完成)**
3. 在服务器上建立一个共享目录,所有人完全控制.将本脚本以及软件安装包复制到共享目录中,确保任意一台计算机可以正常访问以及写入内容
4. 共享目录的目录结构不可随意变更,脚本中硬编码了目录名,如果不安要求来,安装将不会开始(会提示未检测到必要的文件).
5. 确定AIC的计算机名,如果AIC的计算机名不含有**AIC**字样,把AIC的计算机名写在AICList.txt中,一行一个
6. 将下面的两个SPT配置文件内容清空,防止安装过程中自动重启

```
   OpenLab (CDS, ECMXT)~2.5~(Client, CMServices)~Win10.sysprep
   OpenLab CDS~2.5~AIC~Win10.sysprep
```

### 要求的目录结构

```
共享根路径
├─OpenLabCDS-2.5.927(**)
│  ├─Drivers(**)
│  │  ├─10-GC Drivers.msi
│  │  └-其他msi格式安装包,名称随意,按名称顺序进行安装
│  ├-clt.properties(**)
│  ├-aic.properties(**这两个文件参考手册自行生成)
│  ├-OpenLab_CDS_Update.exe(**如果有补丁,将客户端补丁解压出来的这个文件放在此处,如果没有,就不用管了)
│  └-setup.exe(其他标准的文件此处不再列出)
├─dotNet(**)
│  ├─1909
│  ├─2004
│  ├─2009
│  └─其他年份版本的netfx3运行库,win10版本要写正确
└─AutoInst(本脚本位置,目录名可更改)
```

上面的文件结构中,标注有两个*符号的文件名或者目录名均不可更改
